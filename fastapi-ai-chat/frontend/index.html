<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FastAPI AI Chat</title>
    <link rel="icon" type="image/png" href="/Images/fav.png" />
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body>
    <div id="container">
      <h2>FastAPI AI Chat</h2>
          <button id="hamburgerBtn" class="hamburger" aria-label="Toggle menu">
            ☰
          </button>
      <div id="mainLayout">
        <div id="sidebar">
          <div class="sidebar-card">
            <h4>Active Users</h4>
            <div id="usersList">
              <div class="user-item">Loading users...</div>
            </div>
          </div>
          <div class="sidebar-card">
            <h4>Friend Requests</h4>
            <div id="friendRequestsList">
              <div class="user-item">Loading requests...</div>
            </div>
          </div>
          <div class="sidebar-card friends-section">
            <h4>My Friends</h4>
            <div id="friendsList">
              <div class="user-item">Loading friends...</div>
            </div>
          </div>
        </div>
      <div id="mainContent">
        <div class="auth-wrapper" id="authWrapper">
          <div class="auth-frame">
            <div class="auth-inner">
              <div class="auth-tabs" role="tablist" aria-label="Authentication tabs">
                <button class="auth-tab is-active" data-auth="login" type="button" role="tab" aria-selected="true" aria-controls="loginCard">Login</button>
                <button class="auth-tab" data-auth="register" type="button" role="tab" aria-selected="false" aria-controls="authCard">Register</button>
              </div>

              <div class="auth-panel is-active" id="loginCard" role="tabpanel">
                <h3>Login</h3>
                <div class="row">
                  <div class="field">
                    <label for="loginEmail">Email</label>
                    <input id="loginEmail" type="email" placeholder="you@example.com" />
                  </div>
                </div>
                <div class="row">
                  <div class="field">
                    <label for="loginPassword">Password</label>
                    <input id="loginPassword" type="password" placeholder="••••••" />
                  </div>
                </div>
                <button id="loginBtn">Login</button>
                <div id="loginStatus"></div>
              </div>

              <div class="auth-panel" id="authCard" role="tabpanel">
                <h3>Register</h3>
                <div class="row">
                  <div class="field">
                    <label for="regEmail">Email</label>
                    <input id="regEmail" type="email" placeholder="you@example.com" />
                  </div>
                  <div class="field">
                    <label for="regUsername">Username</label>
                    <input id="regUsername" type="text" placeholder="username" />
                  </div>
                </div>
                <div class="row">
                  <div class="field">
                    <label for="regPassword">Password</label>
                    <input id="regPassword" type="password" placeholder="••••••" />
                  </div>
                  <div class="field">
                    <label for="regFullname">Full name</label>
                    <input id="regFullname" type="text" placeholder="Optional" />
                  </div>
                </div>
                <button id="registerBtn">Register</button>
              </div>
            </div>
          </div>
        </div>

      <div class="card is-hidden" id="dashboardCard">
        <div class="dashboard-header">
          <div class="dashboard-title">
            <h3>Dashboard</h3>
            <p class="dashboard-subtitle">Your activity hub for chats and connections</p>
          </div>
          <div class="dashboard-actions">
            <span id="currentUserName" class="user-pill">User</span>
            <span id="status" class="status-pill hidden"></span>
            <button id="logoutBtn" class="logout-btn">Logout</button>
          </div>
        </div>

        <div class="dashboard-content">
          <div class="dashboard-stats">
            <div class="stat-card">
              <h4>Welcome back!</h4>
              <p>You are now logged into your dashboard. Use the sidebar to manage your friends and start chatting.</p>
            </div>
            <div class="stat-card actions-card">
              <h4>Command Center</h4>
              <div class="action-buttons">
                <button id="refreshUsersBtn" onclick="refreshUsersAction()" class="action-btn">Refresh Users</button>
                <button id="refreshFriendsBtn" onclick="refreshFriendsAction()" class="action-btn">Refresh Friends</button>
                <button id="checkRequestsBtn" onclick="checkRequestsAction()" class="action-btn">Check Requests</button>
              </div>
            </div>
          </div>

          <div class="dashboard-info">
            <h4>Getting Started</h4>
            <ul>
              <li><strong>Find Friends:</strong> Browse active users in the sidebar and send friend requests</li>
              <li><strong>Chat:</strong> Once you have friends, click the "Chat" button to start a conversation</li>
              <li><strong>Manage Friends:</strong> Accept/decline friend requests and remove friends as needed</li>
              <li><strong>Real-time Updates:</strong> All changes happen instantly thanks to WebSocket connections</li>
            </ul>
          </div>
        </div>
      </div>
      </div>
    </div>

    <!-- Chat notification
    <div id="chat-notification" class="chat-notification" onclick="openChatFromNotification()">
      <div id="notification-content">New message</div>
    </div> -->

    <!-- Chat windows will be dynamically added here -->
    <div id="chat-windows"></div>

    <!-- Incoming call modal -->
    <div id="incoming-call" class="incoming-call">
      <div class="incoming-card">
        <h3 id="incoming-title" class="incoming-title">Incoming call</h3>
        <p id="incoming-subtitle" class="incoming-subtitle">Someone is calling you</p>
        <div class="incoming-actions">
          <button id="incoming-accept" class="incoming-btn incoming-accept">Accept</button>
          <button id="incoming-decline" class="incoming-btn incoming-decline">Decline</button>
        </div>
      </div>
    </div>

    <!-- Video call overlay -->
    <div id="video-call-overlay" class="video-call-overlay">
      <div class="video-call-card">
        <div class="video-grid">
          <div class="video-call-topbar">
            <span id="vc-title">Video Call</span>
            <span id="vc-status">Connecting...</span>
          </div>
          <video id="remote-video" class="video-remote" autoplay playsinline></video>
          <video id="local-video" class="video-local" autoplay playsinline muted></video>
          <div class="video-call-controls">
            <button id="vc-mic" class="vc-btn active" title="Mute / Unmute">
              <img id="vc-mic-icon" class="vc-icon" src="/Images/microphone.png" alt="Microphone">
              <span class="vc-label" id="vc-mic-label">Unmuted</span>
            </button>
            <button id="vc-cam" class="vc-btn active" title="Camera On / Off">
              <img id="vc-cam-icon" class="vc-icon" src="/Images/video-camera.png" alt="Camera on">
              <span class="vc-label" id="vc-cam-label">Camera on</span>
            </button>
            <button id="vc-end" class="vc-btn end" title="End call">
              <img class="vc-icon" src="/Images/telephone.png" alt="End call">
              <span class="vc-label">End call</span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Context menu for message actions -->
    <div id="message-context-menu" class="message-context-menu">
      <div id="context-menu-reply" class="context-menu-item">Reply</div>
      <div id="context-menu-copy" class="context-menu-item">Copy Message</div>
      <div id="context-menu-edit" class="context-menu-item">Edit Message</div>
      <div id="context-menu-delete" class="context-menu-item danger">Delete Message</div>
    </div>

    <!-- Footer -->
    <footer id="footer">
      Made with lots of ❤️
    </footer>

    <!-- Made for J Modal -->
    <div id="madeForJModal" class="modal-overlay">
      <div class="modal-content">
        <h1>✨ Made For J ✨</h1>
        <p>This amazing chat application was created with dedication and passion.</p>
        <p>Thank you for being part of this journey! ❤️</p>
        <button class="modal-close" id="madeForJClose">Close</button>
      </div>
    </div>

    <script src="/app.js"></script>
    <script src="emoji-picker.js"></script>
  </body>
</html>
